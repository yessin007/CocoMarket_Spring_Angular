import { Directive, EventEmitter, Input, Output, } from '@angular/core';
import { hasWindowDefined, inputPropChanged } from './services/ngx-ins-utils';
import { createScroller, InfiniteScrollActions, } from './services/scroll-register';
import * as i0 from "@angular/core";
export class InfiniteScrollDirective {
    constructor(element, zone) {
        this.element = element;
        this.zone = zone;
        this.scrolled = new EventEmitter();
        this.scrolledUp = new EventEmitter();
        this.infiniteScrollDistance = 2;
        this.infiniteScrollUpDistance = 1.5;
        this.infiniteScrollThrottle = 150;
        this.infiniteScrollDisabled = false;
        this.infiniteScrollContainer = null;
        this.scrollWindow = true;
        this.immediateCheck = false;
        this.horizontal = false;
        this.alwaysCallback = false;
        this.fromRoot = false;
    }
    ngAfterViewInit() {
        if (!this.infiniteScrollDisabled) {
            this.setup();
        }
    }
    ngOnChanges({ infiniteScrollContainer, infiniteScrollDisabled, infiniteScrollDistance, }) {
        const containerChanged = inputPropChanged(infiniteScrollContainer);
        const disabledChanged = inputPropChanged(infiniteScrollDisabled);
        const distanceChanged = inputPropChanged(infiniteScrollDistance);
        const shouldSetup = (!disabledChanged && !this.infiniteScrollDisabled) ||
            (disabledChanged && !infiniteScrollDisabled.currentValue) ||
            distanceChanged;
        if (containerChanged || disabledChanged || distanceChanged) {
            this.destroyScroller();
            if (shouldSetup) {
                this.setup();
            }
        }
    }
    setup() {
        if (hasWindowDefined()) {
            this.zone.runOutsideAngular(() => {
                this.disposeScroller = createScroller({
                    fromRoot: this.fromRoot,
                    alwaysCallback: this.alwaysCallback,
                    disable: this.infiniteScrollDisabled,
                    downDistance: this.infiniteScrollDistance,
                    element: this.element,
                    horizontal: this.horizontal,
                    scrollContainer: this.infiniteScrollContainer,
                    scrollWindow: this.scrollWindow,
                    throttle: this.infiniteScrollThrottle,
                    upDistance: this.infiniteScrollUpDistance,
                }).subscribe((payload) => this.handleOnScroll(payload));
            });
        }
    }
    handleOnScroll({ type, payload }) {
        const emitter = type === InfiniteScrollActions.DOWN ? this.scrolled : this.scrolledUp;
        if (hasObservers(emitter)) {
            this.zone.run(() => emitter.emit(payload));
        }
    }
    ngOnDestroy() {
        this.destroyScroller();
    }
    destroyScroller() {
        if (this.disposeScroller) {
            this.disposeScroller.unsubscribe();
        }
    }
}
InfiniteScrollDirective.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "15.0.3", ngImport: i0, type: InfiniteScrollDirective, deps: [{ token: i0.ElementRef }, { token: i0.NgZone }], target: i0.ɵɵFactoryTarget.Directive });
InfiniteScrollDirective.ɵdir = i0.ɵɵngDeclareDirective({ minVersion: "14.0.0", version: "15.0.3", type: InfiniteScrollDirective, selector: "[infiniteScroll], [infinite-scroll], [data-infinite-scroll]", inputs: { infiniteScrollDistance: "infiniteScrollDistance", infiniteScrollUpDistance: "infiniteScrollUpDistance", infiniteScrollThrottle: "infiniteScrollThrottle", infiniteScrollDisabled: "infiniteScrollDisabled", infiniteScrollContainer: "infiniteScrollContainer", scrollWindow: "scrollWindow", immediateCheck: "immediateCheck", horizontal: "horizontal", alwaysCallback: "alwaysCallback", fromRoot: "fromRoot" }, outputs: { scrolled: "scrolled", scrolledUp: "scrolledUp" }, usesOnChanges: true, ngImport: i0 });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "15.0.3", ngImport: i0, type: InfiniteScrollDirective, decorators: [{
            type: Directive,
            args: [{
                    selector: '[infiniteScroll], [infinite-scroll], [data-infinite-scroll]',
                }]
        }], ctorParameters: function () { return [{ type: i0.ElementRef }, { type: i0.NgZone }]; }, propDecorators: { scrolled: [{
                type: Output
            }], scrolledUp: [{
                type: Output
            }], infiniteScrollDistance: [{
                type: Input
            }], infiniteScrollUpDistance: [{
                type: Input
            }], infiniteScrollThrottle: [{
                type: Input
            }], infiniteScrollDisabled: [{
                type: Input
            }], infiniteScrollContainer: [{
                type: Input
            }], scrollWindow: [{
                type: Input
            }], immediateCheck: [{
                type: Input
            }], horizontal: [{
                type: Input
            }], alwaysCallback: [{
                type: Input
            }], fromRoot: [{
                type: Input
            }] } });
function hasObservers(emitter) {
    // Note: The `observed` property is available only in RxJS@7.2.0, which means it's
    // not available for users running the lower version.
    return emitter.observed ?? emitter.observers.length > 0;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmd4LWluZmluaXRlLXNjcm9sbC5kaXJlY3RpdmUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9wcm9qZWN0cy9uZ3gtaW5maW5pdGUtc2Nyb2xsL3NyYy9saWIvbmd4LWluZmluaXRlLXNjcm9sbC5kaXJlY3RpdmUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUVMLFNBQVMsRUFFVCxZQUFZLEVBQ1osS0FBSyxFQUlMLE1BQU0sR0FFUCxNQUFNLGVBQWUsQ0FBQztBQUl2QixPQUFPLEVBQUUsZ0JBQWdCLEVBQUUsZ0JBQWdCLEVBQUUsTUFBTSwwQkFBMEIsQ0FBQztBQUM5RSxPQUFPLEVBQ0wsY0FBYyxFQUNkLHFCQUFxQixHQUN0QixNQUFNLDRCQUE0QixDQUFDOztBQUtwQyxNQUFNLE9BQU8sdUJBQXVCO0lBbUJsQyxZQUFvQixPQUFtQixFQUFVLElBQVk7UUFBekMsWUFBTyxHQUFQLE9BQU8sQ0FBWTtRQUFVLFNBQUksR0FBSixJQUFJLENBQVE7UUFoQm5ELGFBQVEsR0FBRyxJQUFJLFlBQVksRUFBd0IsQ0FBQztRQUNwRCxlQUFVLEdBQUcsSUFBSSxZQUFZLEVBQXdCLENBQUM7UUFFdkQsMkJBQXNCLEdBQVcsQ0FBQyxDQUFDO1FBQ25DLDZCQUF3QixHQUFXLEdBQUcsQ0FBQztRQUN2QywyQkFBc0IsR0FBVyxHQUFHLENBQUM7UUFDckMsMkJBQXNCLEdBQVksS0FBSyxDQUFDO1FBQ3hDLDRCQUF1QixHQUFRLElBQUksQ0FBQztRQUNwQyxpQkFBWSxHQUFZLElBQUksQ0FBQztRQUM3QixtQkFBYyxHQUFZLEtBQUssQ0FBQztRQUNoQyxlQUFVLEdBQVksS0FBSyxDQUFDO1FBQzVCLG1CQUFjLEdBQVksS0FBSyxDQUFDO1FBQ2hDLGFBQVEsR0FBWSxLQUFLLENBQUM7SUFJNkIsQ0FBQztJQUVqRSxlQUFlO1FBQ2IsSUFBSSxDQUFDLElBQUksQ0FBQyxzQkFBc0IsRUFBRTtZQUNoQyxJQUFJLENBQUMs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QUFLO2dCQUNHLFlBQVk7c0JBQXBCLEtBQUs7Z0JBQ0csY0FBYztzQkFBdEIsS0FBSztnQkFDRyxVQUFVO3NCQUFsQixLQUFLO2dCQUNHLGNBQWM7c0JBQXRCLEtBQUs7Z0JBQ0csUUFBUTtzQkFBaEIsS0FBSzs7QUF3RVIsU0FBUyxZQUFZLENBQUksT0FBd0I7SUFDL0Msa0ZBQWtGO0lBQ2xGLHFEQUFxRDtJQUNyRCxPQUFPLE9BQU8sQ0FBQyxRQUFRLElBQUksT0FBTyxDQUFDLFNBQVMsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDO0FBQzFELENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBBZnRlclZpZXdJbml0LFxuICBEaXJlY3RpdmUsXG4gIEVsZW1lbnRSZWYsXG4gIEV2ZW50RW1pdHRlcixcbiAgSW5wdXQsXG4gIE5nWm9uZSxcbiAgT25DaGFuZ2VzLFxuICBPbkRlc3Ryb3ksXG4gIE91dHB1dCxcbiAgU2ltcGxlQ2hhbmdlcyxcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBTdWJzY3JpcHRpb24gfSBmcm9tICdyeGpzJztcblxuaW1wb3J0IHsgSUluZmluaXRlU2Nyb2xsRXZlbnQsIElJbmZpbml0ZVNjcm9sbEFjdGlvbiB9IGZyb20gJy4uL21vZGVscyc7XG5pbXBvcnQgeyBoYXNXaW5kb3dEZWZpbmVkLCBpbnB1dFByb3BDaGFuZ2VkIH0gZnJvbSAnLi9zZXJ2aWNlcy9uZ3gtaW5zLXV0aWxzJztcbmltcG9ydCB7XG4gIGNyZWF0ZVNjcm9sbGVyLFxuICBJbmZpbml0ZVNjcm9sbEFjdGlvbnMsXG59IGZyb20gJy4vc2VydmljZXMvc2Nyb2xsLXJlZ2lzdGVyJztcblxuQERpcmVjdGl2ZSh7XG4gIHNlbGVjdG9yOiAnW2luZmluaXRlU2Nyb2xsXSwgW2luZmluaXRlLXNjcm9sbF0sIFtkYXRhLWluZmluaXRlLXNjcm9sbF0nLFxufSlcbmV4cG9ydCBjbGFzcyBJbmZpbml0ZVNjcm9sbERpcmVjdGl2ZVxuICBpbXBsZW1lbnRzIE9uRGVzdHJveSwgT25DaGFuZ2VzLCBBZnRlclZpZXdJbml0XG57XG4gIEBPdXRwdXQoKSBzY3JvbGxlZCA9IG5ldyBFdmVudEVtaXR0ZXI8SUluZmluaXRlU2Nyb2xsRXZlbnQ+KCk7XG4gIEBPdXRwdXQoKSBzY3JvbGxlZFVwID0gbmV3IEV2ZW50RW1pdHRlcjxJSW5maW5pdGVTY3JvbGxFdmVudD4oKTtcblxuICBASW5wdXQoKSBpbmZpbml0ZVNjcm9sbERpc3RhbmNlOiBudW1iZXIgPSAyO1xuICBASW5wdXQoKSBpbmZpbml0ZVNjcm9sbFVwRGlzdGFuY2U6IG51bWJlciA9IDEuNTtcbiAgQElucHV0KCkgaW5maW5pdGVTY3JvbGxUaHJvdHRsZTogbnVtYmVyID0gMTUwO1xuICBASW5wdXQoKSBpbmZpbml0ZVNjcm9sbERpc2FibGVkOiBib29sZWFuID0gZmFsc2U7XG4gIEBJbnB1dCgpIGluZmluaXRlU2Nyb2xsQ29udGFpbmVyOiBhbnkgPSBudWxsO1xuICBASW5wdXQoKSBzY3JvbGxXaW5kb3c6IGJvb2xlYW4gPSB0cnVlO1xuICBASW5wdXQoKSBpbW1lZGlhdGVDaGVjazogYm9vbGVhbiA9IGZhbHNlO1xuICBASW5wdXQoKSBob3Jpem9udGFsOiBib29sZWFuID0gZmFsc2U7XG4gIEBJbnB1dCgpIGFsd2F5c0NhbGxiYWNrOiBib29sZWFuID0gZmFsc2U7XG4gIEBJbnB1dCgpIGZyb21Sb290OiBib29sZWFuID0gZmFsc2U7XG5cbiAgcHJpdmF0ZSBkaXNwb3NlU2Nyb2xsZXI/OiBTdWJzY3JpcHRpb247XG5cbiAgY29uc3RydWN0b3IocHJpdmF0ZSBlbGVtZW50OiBFbGVtZW50UmVmLCBwcml2YXRlIHpvbmU6IE5nWm9uZSkge31cblxuICBuZ0FmdGVyVmlld0luaXQoKSB7XG4gICAgaWYgKCF0aGlzLmluZmluaXRlU2Nyb2xsRGlzYWJsZWQpIHtcbiAgICAgIHRoaXMuc2V0dXAoKTtcbiAgICB9XG4gIH1cblxuICBuZ09uQ2hhbmdlcyh7XG4gICAgaW5maW5pdGVTY3JvbGxDb250YWluZXIsXG4gICAgaW5maW5pdGVTY3JvbGxEaXNhYmxlZCxcbiAgICBpbmZpbml0ZVNjcm9sbERpc3RhbmNlLFxuICB9OiBTaW1wbGVDaGFuZ2VzKSB7XG4gICAgY29uc3QgY29udGFpbmVyQ2hhbmdlZCA9IGlucHV0UHJvcENoYW5nZWQoaW5maW5pdGVTY3JvbGxDb250YWluZXIpO1xuICAgIGNvbnN0IGRpc2FibGVkQ2hhbmdlZCA9IGlucHV0UHJvcENoYW5nZWQoaW5maW5pdGVTY3JvbGxEaXNhYmxlZCk7XG4gICAgY29uc3QgZGlzdGFuY2VDaGFuZ2VkID0gaW5wdXRQcm9wQ2hhbmdlZChpbmZpbml0ZVNjcm9sbERpc3RhbmNlKTtcbiAgICBjb25zdCBzaG91bGRTZXR1cCA9XG4gICAgICAoIWRpc2FibGVkQ2hhbmdlZCAmJiAhdGhpcy5pbmZpbml0ZVNjcm9sbERpc2FibGVkKSB8fFxuICAgICAgKGRpc2FibGVkQ2hhbmdlZCAmJiAhaW5maW5pdGVTY3JvbGxEaXNhYmxlZC5jdXJyZW50VmFsdWUpIHx8XG4gICAgICBkaXN0YW5jZUNoYW5nZWQ7XG5cbiAgICBpZiAoY29udGFpbmVyQ2hhbmdlZCB8fCBkaXNhYmxlZENoYW5nZWQgfHwgZGlzdGFuY2VDaGFuZ2VkKSB7XG4gICAgICB0aGlzLmRlc3Ryb3lTY3JvbGxlcigpO1xuICAgICAgaWYgKHNob3VsZFNldHVwKSB7XG4gICAgICAgIHRoaXMuc2V0dXAoKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBzZXR1cCgpIHtcbiAgICBpZiAoaGFzV2luZG93RGVmaW5lZCgpKSB7XG4gICAgICB0aGlzLnpvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4ge1xuICAgICAgICB0aGlzLmRpc3Bvc2VTY3JvbGxlciA9IGNyZWF0ZVNjcm9sbGVyKHtcbiAgICAgICAgICBmcm9tUm9vdDogdGhpcy5mcm9tUm9vdCxcbiAgICAgICAgICBhbHdheXNDYWxsYmFjazogdGhpcy5hbHdheXNDYWxsYmFjayxcbiAgICAgICAgICBkaXNhYmxlOiB0aGlzLmluZmluaXRlU2Nyb2xsRGlzYWJsZWQsXG4gICAgICAgICAgZG93bkRpc3RhbmNlOiB0aGlzLmluZmluaXRlU2Nyb2xsRGlzdGFuY2UsXG4gICAgICAgICAgZWxlbWVudDogdGhpcy5lbGVtZW50LFxuICAgICAgICAgIGhvcml6b250YWw6IHRoaXMuaG9yaXpvbnRhbCxcbiAgICAgICAgICBzY3JvbGxDb250YWluZXI6IHRoaXMuaW5maW5pdGVTY3JvbGxDb250YWluZXIsXG4gICAgICAgICAgc2Nyb2xsV2luZG93OiB0aGlzLnNjcm9sbFdpbmRvdyxcbiAgICAgICAgICB0aHJvdHRsZTogdGhpcy5pbmZpbml0ZVNjcm9sbFRocm90dGxlLFxuICAgICAgICAgIHVwRGlzdGFuY2U6IHRoaXMuaW5maW5pdGVTY3JvbGxVcERpc3RhbmNlLFxuICAgICAgICB9KS5zdWJzY3JpYmUoKHBheWxvYWQpID0+IHRoaXMuaGFuZGxlT25TY3JvbGwocGF5bG9hZCkpO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgaGFuZGxlT25TY3JvbGwoeyB0eXBlLCBwYXlsb2FkIH06IElJbmZpbml0ZVNjcm9sbEFjdGlvbikge1xuICAgIGNvbnN0IGVtaXR0ZXIgPVxuICAgICAgdHlwZSA9PT0gSW5maW5pdGVTY3JvbGxBY3Rpb25zLkRPV04gPyB0aGlzLnNjcm9sbGVkIDogdGhpcy5zY3JvbGxlZFVwO1xuXG4gICAgaWYgKGhhc09ic2VydmVycyhlbWl0dGVyKSkge1xuICAgICAgdGhpcy56b25lLnJ1bigoKSA9PiBlbWl0dGVyLmVtaXQocGF5bG9hZCkpO1xuICAgIH1cbiAgfVxuXG4gIG5nT25EZXN0cm95KCkge1xuICAgIHRoaXMuZGVzdHJveVNjcm9sbGVyKCk7XG4gIH1cblxuICBkZXN0cm95U2Nyb2xsZXIoKSB7XG4gICAgaWYgKHRoaXMuZGlzcG9zZVNjcm9sbGVyKSB7XG4gICAgICB0aGlzLmRpc3Bvc2VTY3JvbGxlci51bnN1YnNjcmliZSgpO1xuICAgIH1cbiAgfVxufVxuXG5mdW5jdGlvbiBoYXNPYnNlcnZlcnM8VD4oZW1pdHRlcjogRXZlbnRFbWl0dGVyPFQ+KTogYm9vbGVhbiB7XG4gIC8vIE5vdGU6IFRoZSBgb2JzZXJ2ZWRgIHByb3BlcnR5IGlzIGF2YWlsYWJsZSBvbmx5IGluIFJ4SlNANy4yLjAsIHdoaWNoIG1lYW5zIGl0J3NcbiAgLy8gbm90IGF2YWlsYWJsZSBmb3IgdXNlcnMgcnVubmluZyB0aGUgbG93ZXIgdmVyc2lvbi5cbiAgcmV0dXJuIGVtaXR0ZXIub2JzZXJ2ZWQgPz8gZW1pdHRlci5vYnNlcnZlcnMubGVuZ3RoID4gMDtcbn1cbiJdfQ==